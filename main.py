import telebot
import google.generativeai as genai
from secret import *


bot = telebot.TeleBot(BOT_TOKEN)
genai.configure(api_key=GOOGLE_API)

model = genai.GenerativeModel('gemini-pro') 

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å AI
def ask_google_ai(prompt):
    try:
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ç–æ–Ω–∞ –æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Å–∏—Ö–æ–ª–æ–≥
        context = (
            "–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –ø—Å–∏—Ö–æ–ª–æ–≥. "
            "–¢–≤–æ—è —Ü–µ–ª—å ‚Äî –ø–æ–º–æ–≥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –ª—É—á—à–µ, –¥–∞–≤–∞—Ç—å —Å–æ–≤–µ—Ç—ã –∏ –ø—Ä–æ—è–≤–ª—è—Ç—å —Å–æ—á—É–≤—Å—Ç–≤–∏–µ. "
            "–ë—É–¥—å –≤–µ–∂–ª–∏–≤—ã–º, —Ç–∞–∫—Ç–∏—á–Ω—ã–º –∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–º –∫ —ç–º–æ—Ü–∏—è–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞."
            "–†–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–π –Ω–∞ —Ç–æ–º —è–∑—ã–∫–µ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ç–µ–±–µ –æ–±—Ä–∞—â–∞–µ—Ç—å—Å—è —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫! –∏ –¥–∞ –µ—Å–ª–∏ —Å–æ–±–µ—Å–¥–Ω–∏–∫ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –Ω–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–º –∏–ª–∏ –±–µ–ª–æ—Ä—É—Å–∫–æ–º —Ç–æ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–π —Å–Ω–∏–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –Ω–µ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–π –Ω–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–º !"
        )
        full_prompt = f"{context}\n{prompt}"
        response = model.generate_content(full_prompt)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
        return response.text  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ–∫—Å—Ç
    except Exception as e:
        return "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ —Å–º–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à –∑–∞–ø—Ä–æ—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑."


# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
@bot.message_handler(commands=['start'])
def send_welcome(message):
    bot.send_message(
        message.chat.id,
        "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ª–∏—á–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫-–ø—Å–∏—Ö–æ–ª–æ–≥. üòä\n"
        "–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –≤—ã—Å–ª—É—à–∞—Ç—å –≤–∞—Å –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å. –ö–∞–∫ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–≥–æ–¥–Ω—è?"
    )


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(func=lambda message: True)
def handle_message(message):
    user_input = message.text  # –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    response = ask_google_ai(user_input)  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç —É AI
    bot.send_message(message.chat.id, response)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç


# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
bot.polling()
